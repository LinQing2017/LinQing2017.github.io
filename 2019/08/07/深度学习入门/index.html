<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>深度学习读书笔记 | LQing的博客 | “做程序员太辛苦了, 我想换行，我该怎么办?” “敲一下回车。”</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="深度学习,读书笔记">
    <meta name="description" content="一篇关于《动手学深度学习》的读书笔记。 电子书地址：https:&#x2F;&#x2F;zh.gluon.ai&#x2F;">
<meta name="keywords" content="深度学习,读书笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="深度学习读书笔记">
<meta property="og:url" content="https:&#x2F;&#x2F;linqing2017.github.io&#x2F;2019&#x2F;08&#x2F;07&#x2F;%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8&#x2F;index.html">
<meta property="og:site_name" content="LQing的博客">
<meta property="og:description" content="一篇关于《动手学深度学习》的读书笔记。 电子书地址：https:&#x2F;&#x2F;zh.gluon.ai&#x2F;">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;github.com&#x2F;LinQing2017&#x2F;notes&#x2F;blob&#x2F;master&#x2F;pictures&#x2F;%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B.png">
<meta property="og:image" content="https:&#x2F;&#x2F;github.com&#x2F;LinQing2017&#x2F;notes&#x2F;blob&#x2F;master&#x2F;pictures&#x2F;%E4%BA%A4%E5%8F%89%E7%86%B5.png">
<meta property="og:image" content="https:&#x2F;&#x2F;github.com&#x2F;LinQing2017&#x2F;notes&#x2F;blob&#x2F;master&#x2F;pictures&#x2F;%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA%E6%A8%A1%E5%9E%8B.png">
<meta property="og:image" content="https:&#x2F;&#x2F;github.com&#x2F;LinQing2017&#x2F;notes&#x2F;blob&#x2F;master&#x2F;pictures&#x2F;%E6%9D%83%E9%87%8D%E8%A1%B0%E5%87%8F%E5%8E%9F%E7%90%86.png">
<meta property="og:updated_time" content="2019-11-08T10:58:23.128Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;github.com&#x2F;LinQing2017&#x2F;notes&#x2F;blob&#x2F;master&#x2F;pictures&#x2F;%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B.png">
    
        <link rel="alternate" type="application/atom+xml" title="LQing的博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">LQing</h5>
          <a href="mailto:m15651620957@163.com" target="_blank" rel="noopener" title="m15651620957@163.com" class="mail">m15651620957@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LinQing2017" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">深度学习读书笔记</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">深度学习读书笔记</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-08-07T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2019-08-07
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#环境准备"><span class="post-toc-number">1.</span> <span class="post-toc-text">环境准备</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#conda"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">conda</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据操作"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">数据操作</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#自动求梯度"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">自动求梯度</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#深度学习基础"><span class="post-toc-number">2.</span> <span class="post-toc-text">深度学习基础</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#线性回归"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">线性回归</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#softmax回归"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">softmax回归</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#多层感知机"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">多层感知机</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模型选择、欠拟合、过拟合"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">模型选择、欠拟合、过拟合</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#正向传播、反向传播和计算图"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">正向传播、反向传播和计算图</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数值稳定性和模型初始化"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">数值稳定性和模型初始化</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#kaggle赛题"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">kaggle赛题</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MXNet-常用API接口"><span class="post-toc-number">3.</span> <span class="post-toc-text">MXNet 常用API接口</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一些数据集"><span class="post-toc-number">4.</span> <span class="post-toc-text">一些数据集</span></a></li></ol>
        </nav>
    </aside>


<article id="post-深度学习入门"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">深度学习读书笔记</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-08-08 00:00:00" datetime="2019-08-07T16:00:00.000Z"  itemprop="datePublished">2019-08-08</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>一篇关于《动手学深度学习》的读书笔记。</p>
<p>电子书地址：<a href="https://zh.gluon.ai/" target="_blank" rel="noopener">https://zh.gluon.ai/</a></p>
<a id="more"></a>

<h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>《动手学深度学习》基于Apache MXNet提供关于深度学习的Demo，并且提供了配套代码。整个项目通过conda的虚拟环境分发，并提供jupyter方式的可读文档。</p>
<p>安装方式如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装Mincode</span></span><br><span class="line">sh Miniconda3-latest-Linux-x86_64.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载工程文件 https://zh.d2l.ai/d2l-zh-1.0.zip ，并且解压到到d2l-zh文件夹</span></span><br><span class="line">unzip d2l-zh-1.0.zip</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装d2l-zh项目的环境</span></span><br><span class="line">source ~/.bashrc &amp;&amp; conda env create -f environment.yml</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换到项目环境</span></span><br><span class="line">conda activate gluon</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开项目jupyter</span></span><br><span class="line">jupyter notebook --ip=$HOSTNAME --port=9999</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 其他一些命令</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 替换pip源</span></span><br><span class="line">pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除pip源，恢复使用默认源</span></span><br><span class="line">pip config unset global.index-url</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置国内MXNet站点的数据仓库</span></span><br><span class="line">set MXNET_GLUON_REPO=https://apache-mxnet.s3.cn-north-1.amazonaws.com.cn/ jupyter notebook</span><br></pre></td></tr></table></figure>
<h2 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h2><p>Conda是python的软件包管理软件，它和pip的最大不同在于同时提供虚拟环境管理功能，方便用户在多个虚拟环境中切换。</p>
<p>Miniconda是最小的conda安装环境，其中包含了Python2和Python3的运行环境。</p>
<p>Anaconda 是一个开源的Python发行版本，其包含了conda、Python等180多个科学包及其依赖项。</p>
<p>conda常用命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> envname 指代你新建的环境的名称</span></span><br><span class="line">conda create --name envname</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除虚拟环境</span></span><br><span class="line">conda remove --name envname --all</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定python版本</span></span><br><span class="line">conda create -n envname python=3.4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定python版本,以及多个包</span></span><br><span class="line">conda create -n envname python=3.4 scipy=0.15.0 astroib numpy</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给虚拟环境安装包</span></span><br><span class="line">conda install -n envname scipy=0.15.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从文件创建虚拟环境conda install pytorch torchvision cudatoolkit=9.0 -c pytorch</span></span><br><span class="line">conda env create -f environment.yml</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前环境安装的包</span></span><br><span class="line">conda list</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有环境conda install pytorch torchvision cudatoolkit=9.0 -c pytorch</span></span><br><span class="line">conda info --envs</span><br><span class="line"><span class="meta">#</span><span class="bash"> 激活环境</span></span><br><span class="line">conda activate envnameconda install pytorch torchvision cudatoolkit=9.0 -c pytorch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出当前环境</span></span><br><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
<h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><p>在MXNet中，NDArray是一个类，也是存储和变换数据的主要工具，提供GPU计算和自动求梯度等多种功能。</p>
<p>NDArray 和 Numpy 有点类似，但是它可以表示多维张量，通过array函数和asnumpy函数可以使数据在NDArray和NumPy格式之间相互变换。</p>
<h2 id="自动求梯度"><a href="#自动求梯度" class="headerlink" title="自动求梯度"></a>自动求梯度</h2><p>MXNet使用autograd模块自动求梯度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> autograd,nd</span><br><span class="line">x = nd.arange(<span class="number">4</span>).reshape((<span class="number">4</span>, <span class="number">1</span>))</span><br><span class="line">x.attach_grad() <span class="comment"># 调用attach_grad申请存储梯度所需要的内存</span></span><br><span class="line"><span class="keyword">with</span> autograd.record(): <span class="comment"># 调用record函数后，MXNet会记录并计算梯度。</span></span><br><span class="line">    y = <span class="number">2</span>* nd.dot(x.T,x) <span class="comment"># 目标函数是 y = x_T * x，我们要求这个函数在x = [0,1,2,3]_T时的梯度</span></span><br><span class="line">    y.backward()</span><br><span class="line">    print(x.grad) <span class="comment"># x.grad 就是对应的梯度</span></span><br></pre></td></tr></table></figure>
<p>参考<a href="https://mxnet.apache.org/api/python/index.html" target="_blank" rel="noopener">mxnet api 查询</a></p>
<h1 id="深度学习基础"><a href="#深度学习基础" class="headerlink" title="深度学习基础"></a>深度学习基础</h1><h2 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h2><p>机器学习的几个概念：</p>
<ul>
<li>样本集、样本、标签</li>
<li>模型、模型参数、损失函数</li>
<li>优化算法：当模型没有解析解时，通过优化算法的有限次迭代求得一个使损失函数最小的数值解。</li>
<li>学习率、批量大小 ——&gt; 超参数</li>
<li>模型预测 ~ 推断 ~ 测试</li>
</ul>
<p>神经网络的几个概念：</p>
<ul>
<li>输入个数 ~ 特征数、特征向量维度</li>
<li>神经元（计算单元）</li>
<li>全连接层、稠密层</li>
</ul>
<p>神经网络和线性回归的联系：</p>
<ul>
<li>线性回归是一个全连接单层神经网络</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/LinQing2017/notes/blob/master/pictures/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>


<h2 id="softmax回归"><a href="#softmax回归" class="headerlink" title="softmax回归"></a>softmax回归</h2><p>解决分类问题的思路：</p>
<ul>
<li>输出是离散值的分类问题，且输出个数等于标签类别数</li>
<li>每个输出值是预测该类别的置信度，预测结果取最大输出值对应的类别</li>
</ul>
<p>上述思路存在问题：</p>
<ul>
<li>输出值的范围不确定，难以直观判断这些值的含义</li>
</ul>
<p>SoftMax回归的解决思路：</p>
<ul>
<li>将输出值变换成值为正且和为1的概率分布（归一化？？？实际上就是：每个输出求exp(y_i)/所有输出exp(y_i)之和）</li>
</ul>
<p>交叉熵损失函数：</p>
<ul>
<li>分类问题的label一般这样表示：[1,0,0,0]（四个类别时，分类取值为1）</li>
<li>分类问题的模型输出表示为：[p1,p2,p3,p4]（四个类别时，表示对应类别0~1之间的概率）</li>
<li>分类问题不适合使用平方损失函数，适合使用<strong>交叉熵</strong>衡量损失。</li>
<li>交叉熵损失函数和最大似然估计的思想一致。</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/LinQing2017/notes/blob/master/pictures/%E4%BA%A4%E5%8F%89%E7%86%B5.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>分类的结果：</p>
<ul>
<li>准确率 = 正确预测数量 / 总预测数量</li>
</ul>
<h2 id="多层感知机"><a href="#多层感知机" class="headerlink" title="多层感知机"></a>多层感知机</h2><ul>
<li><p>不引入激活函数时，<strong>全连接</strong>多层感知机的模型本质上和单层感知机等价的，依然是线性模型。本质上<strong>全连接</strong>等价于<strong>仿射变换（一个向量空间进行一次线性变换并接上一个平移，变换为另一个向量空间。）</strong>，多个<strong>仿射变换</strong>的叠加依然是仿射变换。</p>
</li>
<li><p>解决上述问题：隐藏变量使用按元素运算的非线性函数进行变换，这些非线性函数称谓激活函数</p>
<ul>
<li>ReLU(x)=max(x,0)</li>
<li>sigmoid函数：sigmoid(x)=1/(1+exp(−x))</li>
<li>tanh函数: tanh(x)=(1−exp(−2x))/(1+exp(−2x))</li>
</ul>
</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/LinQing2017/notes/blob/master/pictures/%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA%E6%A8%A1%E5%9E%8B.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="模型选择、欠拟合、过拟合"><a href="#模型选择、欠拟合、过拟合" class="headerlink" title="模型选择、欠拟合、过拟合"></a>模型选择、欠拟合、过拟合</h2><ul>
<li><p>当模型在训练数据集上更准确时，它在测试数据集上却不一定更准确：</p>
<ul>
<li>训练误差（training error）：模型在训练数据集上表现出的误差</li>
<li>泛化误差（generalization error）：模型在任意一个测试数据样本上表现出的误差的期望，并常常通过测试数据集上的误差来近似。</li>
</ul>
</li>
<li><p>K折交叉验证：把原始训练数据集分割成K个不重合的子数据集，然后我们做K次模型训练和验证。每一次，我们使用一个子数据集验证模型，并使用其他K−1个子数据集来训练模型。在这K次训练和验证中，每次用来验证模型的子数据集都不同。最后，我们对这K次训练误差和验证误差分别求平均。</p>
</li>
<li><p>防止过拟合的方法：</p>
<ul>
<li>增大训练量</li>
<li>使用复杂度合适的模型</li>
<li>丢弃法：倒置丢弃法，原理是将隐藏层的输出丢弃或者拉伸。</li>
<li>权重衰减：为模型添加损失函数惩罚项，使学出的模型参数值较小。原因是复杂模型往往权重参数很多，比较复杂。</li>
</ul>
</li>
</ul>
<p>权重衰减使，如何定义损失函数：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/LinQing2017/notes/blob/master/pictures/%E6%9D%83%E9%87%8D%E8%A1%B0%E5%87%8F%E5%8E%9F%E7%90%86.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="正向传播、反向传播和计算图"><a href="#正向传播、反向传播和计算图" class="headerlink" title="正向传播、反向传播和计算图"></a>正向传播、反向传播和计算图</h2><pre><code>知道是什么东西就好？</code></pre><h2 id="数值稳定性和模型初始化"><a href="#数值稳定性和模型初始化" class="headerlink" title="数值稳定性和模型初始化"></a>数值稳定性和模型初始化</h2><ul>
<li>数值稳定性：典型问题是衰减和爆炸，当神经网络层数较多时，模型的数值稳定性容易变差；</li>
<li>通常需要随机初始化神经网络的模型参数，如权重参数。</li>
</ul>
<h2 id="kaggle赛题"><a href="#kaggle赛题" class="headerlink" title="kaggle赛题"></a>kaggle赛题</h2><p><a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/leaderboard" target="_blank" rel="noopener">房价预测</a>，通过观摩别人的解题过程发现，大致流程如下：</p>
<ul>
<li>理解问题：理解数据的规模、指标的含义、数据有哪些确实等等。</li>
<li>单因素研究：关注单一变量（如，输出）作图，并分析</li>
<li>多因素研究：分析因变量和自变量之间的关系。</li>
<li>基础清洗：清洗数据集并且对缺失数据，异常值和分类数据进行一些处理。</li>
<li>检验假设：检查数据是否和多元分析方法的假设达到一致。</li>
<li>建立模型，训练，预测<h1 id="MXNet-常用API接口"><a href="#MXNet-常用API接口" class="headerlink" title="MXNet 常用API接口"></a>MXNet 常用API接口</h1></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> nn</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 定义一个神经网络模型，定义若干层隐藏层，并且指定隐藏层的激活类型， Dense表示定义一个全连接层。</span></span><br><span class="line"></span><br><span class="line">    net = nn.Sequential()</span><br><span class="line">    net.add(</span><br><span class="line">        nn.Dense(<span class="number">1024</span>, activation=<span class="string">'relu'</span>),</span><br><span class="line">        nn.Dense(<span class="number">1</span>)</span><br><span class="line">    )</span><br><span class="line">    net.initialize(init.Normal(sigma=<span class="number">0.01</span>))</span><br><span class="line">    <span class="keyword">return</span> net</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> loss <span class="keyword">as</span> gloss</span><br><span class="line"><span class="comment"># 定义损失函数</span></span><br><span class="line">loss = gloss.L2Loss()                   <span class="comment"># 均方根损失</span></span><br><span class="line">loss = gloss.SoftmaxCrossEntropyLoss()  <span class="comment"># 交叉熵损失</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> data <span class="keyword">as</span> gdata</span><br><span class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> autograd, gluon, init, nd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(net, train_features, train_labels, test_features, test_labels,</span></span></span><br><span class="line"><span class="function"><span class="params">          num_epochs, learning_rate, weight_decay, batch_size)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        训练函数</span></span><br><span class="line"><span class="string">    :param net               :模型        </span></span><br><span class="line"><span class="string">    :param train_features    :训练集的特征</span></span><br><span class="line"><span class="string">    :param train_labels      :训练集的标签</span></span><br><span class="line"><span class="string">    :param test_features     :测试集的特征</span></span><br><span class="line"><span class="string">    :param test_labels       :测试集的标签</span></span><br><span class="line"><span class="string">    :param num_epochs        :在训练集上的训练次数，每次训练由多个小批量样本迭代组成</span></span><br><span class="line"><span class="string">    :param learning_rate     :每次迭代的学习率</span></span><br><span class="line"><span class="string">    :param weight_decay      :权重衰减系数，防止过拟合</span></span><br><span class="line"><span class="string">    :param batch_size        :小批量样本迭代中的样本数目</span></span><br><span class="line"><span class="string">    :return                  :输出结果，即训练误差和测试误差（验证误差）</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    train_ls, test_ls = [], []</span><br><span class="line">    train_iter = gdata.DataLoader(  <span class="comment"># 将训练集进行随机小批量分割</span></span><br><span class="line">        gdata.ArrayDataset(train_features, train_labels),</span><br><span class="line">        batch_size,</span><br><span class="line">        shuffle=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    trainer = gluon.Trainer(        <span class="comment"># 使用一个trainer，'adam'表示学习迭代的方法，同样还有sgd</span></span><br><span class="line">        net.collect_params(),</span><br><span class="line">        <span class="string">'adam'</span>,</span><br><span class="line">        &#123;<span class="string">'learning_rate'</span>: learning_rate, <span class="string">'wd'</span>: weight_decay&#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> range(num_epochs):</span><br><span class="line">        <span class="keyword">for</span> X, y <span class="keyword">in</span> train_iter:</span><br><span class="line">            <span class="keyword">with</span> autograd.record():</span><br><span class="line">                l = loss(net(X), y)     <span class="comment"># 求损失函数函数</span></span><br><span class="line">            l.backward()                <span class="comment"># 对损失函数的每个变量求偏导</span></span><br><span class="line">            trainer.step(batch_size)    <span class="comment"># 进行模型计算</span></span><br><span class="line">        train_ls.append(loss(net, train_features, train_labels)) </span><br><span class="line">        <span class="keyword">if</span> test_labels <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            test_ls.append(loss(net, test_features, test_labels))</span><br><span class="line">    <span class="keyword">return</span> train_ls, test_ls</span><br></pre></td></tr></table></figure>


<h1 id="一些数据集"><a href="#一些数据集" class="headerlink" title="一些数据集"></a>一些数据集</h1><p>[MNIST]：手写数字识别数据集</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-11-08T10:58:23.128Z" itemprop="dateUpdated">2019-11-08 18:58:23</time>
</span><br>


        
        原文地址 ：<a href="/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" target="_blank" rel="external">https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/</a>
        
    </div>
    
    <footer>
        <a href="https://LinQing2017.github.io">
            <img src="/img/avatar.jpg" alt="LQing">
            LQing
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&title=《深度学习读书笔记》 — LQing的博客&pic=https://LinQing2017.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&title=《深度学习读书笔记》 — LQing的博客&source=一篇关于《动手学深度学习》的读书笔记。
电子书地址：https://zh.gluon.ai/" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《深度学习读书笔记》 — LQing的博客&url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&via=https://LinQing2017.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/08/07/0-ROS%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">ROS环境安装部署</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/07/30/2-Prometheus/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Prometheus Alarm</h4>
      </a>
    </div>
  
</nav>



    

</article>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>LQing &copy; 2015 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&title=《深度学习读书笔记》 — LQing的博客&pic=https://LinQing2017.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&title=《深度学习读书笔记》 — LQing的博客&source=一篇关于《动手学深度学习》的读书笔记。
电子书地址：https://zh.gluon.ai/" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《深度学习读书笔记》 — LQing的博客&url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/&via=https://LinQing2017.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://linqing2017.github.io/2019/08/07/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADJ0lEQVR42u3aQW7CUAwEUO5/6XZbqSKM7Y8UzMsKgRryfqW69vjxiK+fP9f/d559+v/19c9ef0vyVIcvbGxs7A9hV78+f5TkPvn9k2NNLNjY2Nhb2c8A10WoWpbyq3qUuQUbGxsbO2kGkgKTHGL1U2xsbGzsU7fuHcR16cpHXdjY2Njfyc7/3U+m7slj5TFAMpB64ywNGxsb+/bsHuaer9+Sb2NjY2PfmN0b2VdLQj5U6hXRsgIbGxt7ETsvAHkDMI+Bq+Wz9/zY2NjY38Ou3jQf/Vcj5EmMUUhFsLGxsT+QPRkknZ3e5L+A6jJo4cmxsbGxP4qdF6d8gWa+lDNZ3ElaIGxsbOxN7HwV5rogTcrVpI2pljdsbGzsrex8MNQrGL3BUF7q8pYJGxsbex/7VJHIjylf0DnVckSbStjY2Ngr2Hn7UX0/HwnlBaxatLCxsbG3sifLN73xULUgJe1Nr4hiY2Nj72BXY9cJvrfQWV3KKUQC2NjY2OvY1aA0P5r50H+++vO0gGFjY2N/AbvXZlRLTt5s5OwXmTY2Njb2CvY74tv5Gn3SrvTiZGxsbOx97GpE2hv0TIZBhQYjH11hY2NjL2KfGtZXG4zkaJoDo/zXho2Njb2C3Wswem1Gr+HpLXS+sGBjY2OvYz/iqxoMT4pQ73VyENjY2Ni72UnL0VvTnDQ5Z+dC2NjY2FvZZ5uQeUNSLZ+FkomNjY29mp3Hrr04NgmMJ8FwdOjY2NjYX8Bu/ovfaiTyFZ/5kAsbGxt7H7s60E8mM73FnUmBrI6ZsLGxsfexq61CtYRU73yqNL54HxsbG3sdO/k7X16OiY/1HeHxi+/FxsbGXsfOYdftQfVnq5Ftwo7CYGxsbOwV7N5A51Th6R3ugftjY2NjL2JXw4M8lM2HTb2lnGrEO8pMsLGxsW/Prgar1VKXty5V/KiAYWNjY69j90Lc3qfzsVF1qFQIerGxsbG/gF0NAxJwNULovR4VMGxsbOzV7FODoeRxq7Ox8qYSNjY29seyJ8s0kyakN9jKj/VAPICNjY19e3Ye9OarMNU1oOpB57HEaH0HGxsb++7sX4WDVVAPstJRAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>








<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'LQing的博客';
            clearTimeout(titleTime);
        } else {
            document.title = 'LQing的博客';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
